# 更新日志

## [2.0.0] - 2025-11-13

### 新增功能

#### 🎯 多环境支持
- ✅ 支持前端/后端分别部署
- ✅ 支持测试/生产环境分别部署
- ✅ 共支持 4 种环境组合:
  - 前端测试环境 (Frontend Test)
  - 前端生产环境 (Frontend Prod)
  - 后端测试环境 (Backend Test)
  - 后端生产环境 (Backend Prod)

#### 🎛️ Web 界面增强
- ✅ 任务选择复选框,支持多选
- ✅ 快捷操作按钮:
  - 全选
  - 取消全选
  - 仅前端
  - 仅后端
- ✅ 默认全部勾选,一键部署所有环境
- ✅ 部署前弹窗确认,显示将要执行的任务列表

#### 🔧 任务调度器
- ✅ 新增 `task_scheduler.py` 模块
- ✅ 支持多任务批量执行
- ✅ 任务按顺序依次执行,保证稳定性
- ✅ 实时日志推送到 Web 界面
- ✅ 执行完成后显示总结报告

#### ⚙️ 配置管理优化
- ✅ `.env` 支持 4 种环境配置
- ✅ 每个环境独立配置云效 URL、K8s URL、版本号正则
- ✅ 向下兼容原有的单环境配置

### 改进优化

- 🔄 Web 服务支持接收任务列表参数
- 🔄 日志输出更清晰,显示任务进度 (如 "任务 1/2")
- 🔄 失败时显示详细错误信息
- 🔄 执行总结包含成功/失败数量统计

### 技术细节

#### 新增文件
- `task_scheduler.py` - 任务调度器核心模块
- `USAGE.md` - 详细使用说明
- `CHANGELOG.md` - 更新日志

#### 修改文件
- `web_server.py` - 支持多任务选择和执行
- `templates/index.html` - Web 界面升级
- `config.py` - 配置结构优化
- `README.md` - 更新特性说明

### 使用示例

#### 场景 1: 只部署前端测试环境
```
1. 打开 http://localhost:5001
2. 点击 "取消全选"
3. 勾选 "前端 > 测试环境"
4. 点击 "开始部署"
```

#### 场景 2: 部署所有环境
```
1. 打开 http://localhost:5001
2. 保持默认全选状态
3. 点击 "开始部署"
4. 确认弹窗中的任务列表
```

#### 场景 3: 只部署生产环境
```
1. 打开 http://localhost:5001
2. 点击 "取消全选"
3. 勾选 "前端 > 生产环境"
4. 勾选 "后端 > 生产环境"
5. 点击 "开始部署"
```

### 向下兼容

- ✅ 原有的 `python main.py` 命令行方式仍可使用
- ✅ 原有的 `.env` 配置格式仍受支持
- ✅ 原有的登录状态文件 `auth.json` 继续有效

---

## [1.0.0] - 2025-11-12

### 初始版本

- ✅ 基础云效到 K8s 自动部署功能
- ✅ 浏览器自动化操作
- ✅ 登录状态保存
- ✅ Web 界面基础功能
- ✅ 实时日志显示
- ✅ 错误截图保存
